<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Programming for Research</title>
  <meta name="description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R Programming for Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Programming for Research" />
  
  <meta name="twitter:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  

<meta name="author" content="Brooke Anderson and Rachel Severson">


<meta name="date" content="2018-08-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r-preliminaries.html">
<link rel="next" href="appendix-a-vocabulary.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Programming for Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Online course book, ERHS 535</a></li>
<li class="chapter" data-level="" data-path="course-information.html"><a href="course-information.html"><i class="fa fa-check"></i>Course information</a><ul>
<li class="chapter" data-level="0.1" data-path="course-information.html"><a href="course-information.html#course-overview"><i class="fa fa-check"></i><b>0.1</b> Course overview</a></li>
<li class="chapter" data-level="0.2" data-path="course-information.html"><a href="course-information.html#time-and-place"><i class="fa fa-check"></i><b>0.2</b> Time and place</a></li>
<li class="chapter" data-level="0.3" data-path="course-information.html"><a href="course-information.html#detailed-schedule"><i class="fa fa-check"></i><b>0.3</b> Detailed schedule</a></li>
<li class="chapter" data-level="0.4" data-path="course-information.html"><a href="course-information.html#grading"><i class="fa fa-check"></i><b>0.4</b> Grading</a><ul>
<li class="chapter" data-level="0.4.1" data-path="course-information.html"><a href="course-information.html#attendance-and-class-participation"><i class="fa fa-check"></i><b>0.4.1</b> Attendance and class participation</a></li>
<li class="chapter" data-level="0.4.2" data-path="course-information.html"><a href="course-information.html#weekly-in-course-group-exercises"><i class="fa fa-check"></i><b>0.4.2</b> Weekly in-course group exercises</a></li>
<li class="chapter" data-level="0.4.3" data-path="course-information.html"><a href="course-information.html#in-class-quizzes"><i class="fa fa-check"></i><b>0.4.3</b> In-class quizzes</a></li>
<li class="chapter" data-level="0.4.4" data-path="course-information.html"><a href="course-information.html#homework"><i class="fa fa-check"></i><b>0.4.4</b> Homework</a></li>
<li class="chapter" data-level="0.4.5" data-path="course-information.html"><a href="course-information.html#final-group-project"><i class="fa fa-check"></i><b>0.4.5</b> Final group project</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="course-information.html"><a href="course-information.html#course-set-up"><i class="fa fa-check"></i><b>0.5</b> Course set-up</a></li>
<li class="chapter" data-level="0.6" data-path="course-information.html"><a href="course-information.html#coursebook"><i class="fa fa-check"></i><b>0.6</b> Coursebook</a><ul>
<li class="chapter" data-level="0.6.1" data-path="course-information.html"><a href="course-information.html#other-helpful-books-not-required"><i class="fa fa-check"></i><b>0.6.1</b> Other helpful books (not required)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Part I: Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="r-preliminaries.html"><a href="r-preliminaries.html"><i class="fa fa-check"></i><b>1</b> R Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> R and R Studio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-r"><i class="fa fa-check"></i><b>1.2.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#open-source-software"><i class="fa fa-check"></i><b>1.2.2</b> Open-source software</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> What is RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#the-package-system"><i class="fa fa-check"></i><b>1.3</b> The “package” system</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-packages"><i class="fa fa-check"></i><b>1.3.1</b> R packages</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#installing-from-cran"><i class="fa fa-check"></i><b>1.3.2</b> Installing from CRAN</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#loading-an-installed-package"><i class="fa fa-check"></i><b>1.3.3</b> Loading an installed package</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#basic-code-conventions-of-r"><i class="fa fa-check"></i><b>1.4</b> Basic code conventions of R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-objects"><i class="fa fa-check"></i><b>1.4.1</b> R objects</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-mvp-the-gets-arrow"><i class="fa fa-check"></i><b>1.4.2</b> R’s MVP: The <em>gets arrow</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#note-generic-code"><i class="fa fa-check"></i><b>1.5</b> Note: Generic code</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#assignment-operator-wars---vs."><i class="fa fa-check"></i><b>1.5.1</b> Assignment operator wars: <code>&lt;-</code> vs. <code>=</code></a></li>
<li class="chapter" data-level="1.5.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#naming-objects"><i class="fa fa-check"></i><b>1.5.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-most-basic-object-types"><i class="fa fa-check"></i><b>1.6</b> R’s most basic object types</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#vectors"><i class="fa fa-check"></i><b>1.6.1</b> Vectors</a></li>
<li class="chapter" data-level="1.6.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#dataframes"><i class="fa fa-check"></i><b>1.6.2</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-preliminaries.html"><a href="r-preliminaries.html#note-generic-code-1"><i class="fa fa-check"></i><b>1.7</b> Note: Generic code</a></li>
<li class="chapter" data-level="1.8" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-r-functions"><i class="fa fa-check"></i><b>1.8</b> Using R functions</a><ul>
<li class="chapter" data-level="1.8.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-structure"><i class="fa fa-check"></i><b>1.8.1</b> Function structure</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="r-preliminaries.html"><a href="r-preliminaries.html#generic-code"><i class="fa fa-check"></i><b>1.9</b> Generic code</a></li>
<li class="chapter" data-level="1.10" data-path="r-preliminaries.html"><a href="r-preliminaries.html#generic-code-1"><i class="fa fa-check"></i><b>1.10</b> Generic code</a><ul>
<li class="chapter" data-level="1.10.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-help-files"><i class="fa fa-check"></i><b>1.10.1</b> Function help files</a></li>
<li class="chapter" data-level="1.10.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-parameters"><i class="fa fa-check"></i><b>1.10.2</b> Function parameters</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-scripts"><i class="fa fa-check"></i><b>1.11</b> R scripts</a><ul>
<li class="chapter" data-level="1.11.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#commenting-code"><i class="fa fa-check"></i><b>1.11.1</b> Commenting code</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="r-preliminaries.html"><a href="r-preliminaries.html#in-course-exercise"><i class="fa fa-check"></i><b>1.12</b> In-course Exercise</a><ul>
<li class="chapter" data-level="1.12.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#about-the-dataset"><i class="fa fa-check"></i><b>1.12.1</b> About the dataset</a></li>
<li class="chapter" data-level="1.12.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#manually-creating-vectors-and-a-dataframe"><i class="fa fa-check"></i><b>1.12.2</b> Manually creating vectors and a dataframe</a></li>
<li class="chapter" data-level="1.12.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#installing-and-using-a-package"><i class="fa fa-check"></i><b>1.12.3</b> Installing and using a package</a></li>
<li class="chapter" data-level="1.12.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-onto-your-computer"><i class="fa fa-check"></i><b>1.12.4</b> Getting the data onto your computer</a></li>
<li class="chapter" data-level="1.12.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-into-r"><i class="fa fa-check"></i><b>1.12.5</b> Getting the data into R</a></li>
<li class="chapter" data-level="1.12.6" data-path="r-preliminaries.html"><a href="r-preliminaries.html#checking-out-the-data"><i class="fa fa-check"></i><b>1.12.6</b> Checking out the data</a></li>
<li class="chapter" data-level="1.12.7" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-the-data-to-answer-questions"><i class="fa fa-check"></i><b>1.12.7</b> Using the data to answer questions</a></li>
<li class="chapter" data-level="1.12.8" data-path="r-preliminaries.html"><a href="r-preliminaries.html#writing-your-code-as-an-r-script"><i class="fa fa-check"></i><b>1.12.8</b> Writing your code as an R script</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II: Basics</b></span></li>
<li class="chapter" data-level="2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html"><i class="fa fa-check"></i><b>2</b> Entering and cleaning data #1</a><ul>
<li class="chapter" data-level="2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.2</b> Reading data into R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-local-flat-files"><i class="fa fa-check"></i><b>2.2.1</b> Reading local flat files</a></li>
<li class="chapter" data-level="2.2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#the-read_-functions"><i class="fa fa-check"></i><b>2.2.2</b> The <code>read_*</code> functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-online-flat-files"><i class="fa fa-check"></i><b>2.2.3</b> Reading online flat files</a></li>
<li class="chapter" data-level="2.2.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#saving-and-loading-r-objects"><i class="fa fa-check"></i><b>2.2.4</b> Saving and loading R objects</a></li>
<li class="chapter" data-level="2.2.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-other-file-types"><i class="fa fa-check"></i><b>2.2.5</b> Reading other file types</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directories-and-pathnames"><i class="fa fa-check"></i><b>2.3</b> Directories and pathnames</a><ul>
<li class="chapter" data-level="2.3.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directory-structure"><i class="fa fa-check"></i><b>2.3.1</b> Directory structure</a></li>
<li class="chapter" data-level="2.3.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#working-directory"><i class="fa fa-check"></i><b>2.3.2</b> Working directory</a></li>
<li class="chapter" data-level="2.3.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#file-and-directory-pathnames"><i class="fa fa-check"></i><b>2.3.3</b> File and directory pathnames</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#diversion-paste"><i class="fa fa-check"></i><b>2.4</b> Diversion: <code>paste</code></a></li>
<li class="chapter" data-level="2.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#data-cleaning"><i class="fa fa-check"></i><b>2.5</b> Data cleaning</a><ul>
<li class="chapter" data-level="2.5.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#renaming-columns"><i class="fa fa-check"></i><b>2.5.1</b> Renaming columns</a></li>
<li class="chapter" data-level="2.5.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#selecting-columns"><i class="fa fa-check"></i><b>2.5.2</b> Selecting columns</a></li>
<li class="chapter" data-level="2.5.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#filtering-to-certain-rows"><i class="fa fa-check"></i><b>2.5.3</b> Filtering to certain rows</a></li>
<li class="chapter" data-level="2.5.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#add-or-change-columns"><i class="fa fa-check"></i><b>2.5.4</b> Add or change columns</a></li>
<li class="chapter" data-level="2.5.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#piping"><i class="fa fa-check"></i><b>2.5.5</b> Piping</a></li>
<li class="chapter" data-level="2.5.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#base-r-equivalents-to-dplyr-functions"><i class="fa fa-check"></i><b>2.5.6</b> Base R equivalents to <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#dates-in-r"><i class="fa fa-check"></i><b>2.6</b> Dates in R</a></li>
<li class="chapter" data-level="2.7" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#in-course-exercise-1"><i class="fa fa-check"></i><b>2.7</b> In-course Exercise</a><ul>
<li class="chapter" data-level="2.7.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#downloading-and-checking-out-the-example-data"><i class="fa fa-check"></i><b>2.7.1</b> Downloading and checking out the example data</a></li>
<li class="chapter" data-level="2.7.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-in-different-types-of-files"><i class="fa fa-check"></i><b>2.7.2</b> Reading in different types of files</a></li>
<li class="chapter" data-level="2.7.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directory-structure-1"><i class="fa fa-check"></i><b>2.7.3</b> Directory structure</a></li>
<li class="chapter" data-level="2.7.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#cleaning-up-data-1"><i class="fa fa-check"></i><b>2.7.4</b> Cleaning up data #1</a></li>
<li class="chapter" data-level="2.7.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#cleaning-up-data-2"><i class="fa fa-check"></i><b>2.7.5</b> Cleaning up data #2</a></li>
<li class="chapter" data-level="2.7.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#piping-1"><i class="fa fa-check"></i><b>2.7.6</b> Piping</a></li>
<li class="chapter" data-level="2.7.7" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#a-taste-of-whats-to-come"><i class="fa fa-check"></i><b>2.7.7</b> A taste of what’s to come…</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Vocabulary</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-1r-preliminaries-updated-for-2018"><i class="fa fa-check"></i><b>A.1</b> Quiz 1—R Preliminaries (Updated for 2018)</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-2entering-cleaning-data-1"><i class="fa fa-check"></i><b>A.2</b> Quiz 2—Entering / cleaning data #1</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-3"><i class="fa fa-check"></i><b>A.3</b> Quiz 3</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-4"><i class="fa fa-check"></i><b>A.4</b> Quiz 4</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-5"><i class="fa fa-check"></i><b>A.5</b> Quiz 5</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-6"><i class="fa fa-check"></i><b>A.6</b> Quiz 6</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-7"><i class="fa fa-check"></i><b>A.7</b> Quiz 7</a></li>
<li class="chapter" data-level="A.8" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#quiz-8"><i class="fa fa-check"></i><b>A.8</b> Quiz 8</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html"><i class="fa fa-check"></i><b>B</b> Appendix B: Homework</a><ul>
<li class="chapter" data-level="B.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-1-updated-for-2018"><i class="fa fa-check"></i><b>B.1</b> Homework #1 (Updated for 2018)</a><ul>
<li class="chapter" data-level="B.1.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#option-1"><i class="fa fa-check"></i><b>B.1.1</b> Option 1</a></li>
<li class="chapter" data-level="B.1.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#option-2"><i class="fa fa-check"></i><b>B.1.2</b> Option 2</a></li>
<li class="chapter" data-level="B.1.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#special-swirl-commands"><i class="fa fa-check"></i><b>B.1.3</b> Special swirl commands</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-2"><i class="fa fa-check"></i><b>B.2</b> Homework #2</a></li>
<li class="chapter" data-level="B.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-3"><i class="fa fa-check"></i><b>B.3</b> Homework #3</a></li>
<li class="chapter" data-level="B.4" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-4"><i class="fa fa-check"></i><b>B.4</b> Homework #4</a></li>
<li class="chapter" data-level="B.5" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-5"><i class="fa fa-check"></i><b>B.5</b> Homework #5</a></li>
<li class="chapter" data-level="B.6" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-6"><i class="fa fa-check"></i><b>B.6</b> Homework #6</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Programming for Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="entering-and-cleaning-data-1" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Entering and cleaning data #1</h1>
<p><a href="https://github.com/geanders/RProgrammingForResearch/raw/master/slides/CourseNotes_Week2.pdf">Download</a> a pdf of the lecture slides covering this topic.</p>
<div id="overview" class="section level2">
<h2><span class="header-section-number">2.1</span> Overview</h2>
<p>There are four basic steps you will often repeat as you prepare to analyze data in R:</p>
<ol style="list-style-type: decimal">
<li>Identify where the data is (If it’s on your computer, which directory? If it’s online, what’s the url?)</li>
<li>Read data into R (<code>read.csv</code>, <code>read.table</code>) using the file path you figured out in step 1</li>
<li>Check to make sure the data came in correctly (<code>dim</code>, <code>head</code>, <code>tail</code>, <code>str</code>)</li>
<li>Clean the data up</li>
</ol>
<p>In this chapter, I’ll go basics for each of these steps, as well as dive a bit deeper into some related topics you should learn now to make your life easier as you get started using R for research.</p>
</div>
<div id="reading-data-into-r" class="section level2">
<h2><span class="header-section-number">2.2</span> Reading data into R</h2>
<iframe width="652" height="367" src="https://www.youtube.com/embed/DO5f5R4qW1s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
<p>Data comes in files of all shapes and sizes. R has the capability to read data in from many of these, even proprietary files for other software (e.g., Excel and SAS files). As a small sample, here are some of the types of data files that R can read and work with:</p>
<ul>
<li>Flat files (much more about these in just a minute)</li>
<li>Files from other statistical packages (SAS, Excel, Stata, SPSS)</li>
<li>Tables on webpages (e.g., the table on ebola outbreaks near the end of <a href="http://en.wikipedia.org/wiki/Ebola_virus_epidemic_in_West_Africa">this Wikipedia page</a>)</li>
<li>Data in a database (e.g., MySQL, Oracle)</li>
<li>Data in JSON and XML formats</li>
<li>Really crazy data formats used in other disciplines (e.g., netCDF files from climate research, MRI data stored in Analyze, NIfTI, and DICOM formats)</li>
<li>Geographic shapefiles</li>
<li>Data through APIs</li>
</ul>
<p>Often, it is possible to read in and clean up even incredibly messy data, by using functions like <code>scan</code> and <code>readLines</code> to read the data in a line at a time, and then using regular expressions (which I’ll cover in the “Intermediate” section of the course) to clean up each line as it comes in. In over a decade of coding in R, I think the only time I’ve come across a data file I couldn’t get into R was for proprietary precision agriculture data collected at harvest by a combine.</p>
<div id="reading-local-flat-files" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Reading local flat files</h3>
<p>Much of the data that you will want to read in will be in flat files. Basically, these are files that you can open using a text editor; the most common type you’ll work with are probably comma-separated files (often with a <code>.csv</code> or <code>.txt</code> file extension). Most flat files come in two general categories:</p>
<ol style="list-style-type: decimal">
<li><p>Fixed width files</p></li>
<li><p>Delimited files</p></li>
</ol>
<ul>
<li>“.csv”: Comma-separated values</li>
<li>“.tab”, “.tsv”: Tab-separated values</li>
<li>Other possible delimiters: colon, semicolon, pipe (“|”)</li>
</ul>
<p><em>Fixed width files</em> are files where a column always has the same width, for all the rows in the column. These tend to look very neat and easy-to-read when you open them in a text editor. For example, the first few rows of a fixed-width file might look like this:</p>
<pre><code>Course            Number          Day          Time
Intro to Epi      501             M/W/F        9:00-9:50
Advanced Epi      521             T/Th         1:00-2:15</code></pre>
<p><em>Delimited files</em> use some <em>delimiter</em> (for example, a column or a tab) to separate each column value within a row. The first few rows of a delimited file might look like this:</p>
<pre><code>Course, Number, Day, Time
&quot;Intro to Epi&quot;, 501, &quot;M/W/F&quot;, &quot;9:00-9:50&quot;
&quot;Advanced Epi&quot;, 521, &quot;T/Th&quot;, &quot;1:00-2:15&quot;</code></pre>
<p>These flat files can have a number of different file extensions. The most generic is <code>.txt</code>, but they will also have ones more specific to their format, like <code>.csv</code> for a comma-delimited file or <code>.fwf</code> for a fixed with file.</p>
<p>R can read in data from both fixed with and delimited flat files. The only catch is that you need to tell R a bit more about the format of the flat file, including whether it is fixed width or delimited. If the file is fixed width, you will usually have to tell R the width of each column. If the file is delimited, you’ll need to tell R which delimiter is being used.</p>
<p>If the file is delimited, you can use the <code>read.table</code> family of functions to read it in. This family of functions includes several specialized functions. All members of the <code>read.table</code> family are doing the same basic thing. The only difference is what defaults each function has for the separator (<code>sep</code>) and the decimal point (<code>dec</code>). Members of the <code>read.table</code> family include:</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Separator</th>
<th align="left">Decimial point</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>read.table</code></td>
<td align="left">comma</td>
<td align="left">period</td>
</tr>
<tr class="even">
<td align="left"><code>read.csv</code></td>
<td align="left">comma</td>
<td align="left">period</td>
</tr>
<tr class="odd">
<td align="left"><code>read.csv2</code></td>
<td align="left">semi-colon</td>
<td align="left">comma</td>
</tr>
<tr class="even">
<td align="left"><code>read.delim</code></td>
<td align="left">tab</td>
<td align="left">period</td>
</tr>
<tr class="odd">
<td align="left"><code>read.delim2</code></td>
<td align="left">tab</td>
<td align="left">period</td>
</tr>
</tbody>
</table>
<p>You can use <code>read.table</code> to read in any delimited file, regardless of the separator and the value used for the decimal point. However, you will need to specify these values using the <code>sep</code> and <code>dec</code> parameters if they differ from the defaults for <code>read.table</code> (a space for the delimiter and period for the decimal). If you remember the more specialized function call, therefore, you can save yourself some typing. There are a few other default values besides <code>sep</code> and <code>dec</code> that differ between different functions in this family: <code>header</code>, for example, specifies whether the first row should be used as column names.</p>
<p>For example, to read in the Ebola data, which is comma-delimited, you could either use <code>read.table</code> with a <code>sep</code> argument specified or use <code>read.csv</code>, in which case you don’t have to specify <code>sep</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># These two calls do the same thing</span>
ebola &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/country_timeseries.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,
                    <span class="dt">header =</span> <span class="ot">TRUE</span>)
ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/country_timeseries.csv&quot;</span>)</code></pre></div>
<p>These functions have a number of different parameters to help you tell R how to read in data. For example, if the first few lines of the file aren’t part of the tabular data, you can tell R how many rows of the file to skip before it starts reading in the data. If the data uses an unusual value for missing data (e.g., -999), you can specify that, as well. Some of the interesting parameters with the <code>read.table</code> family of functions are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>sep</code></td>
<td align="left">What is the delimiter in the data?</td>
</tr>
<tr class="even">
<td align="left"><code>skip</code></td>
<td align="left">How many lines of the start of the file should you skip?</td>
</tr>
<tr class="odd">
<td align="left"><code>header</code></td>
<td align="left">Does the first line you read give column names?</td>
</tr>
<tr class="even">
<td align="left"><code>as.is</code></td>
<td align="left">Should you bring in strings as characters, not factors?</td>
</tr>
<tr class="odd">
<td align="left"><code>nrows</code></td>
<td align="left">How many rows do you want to read in?</td>
</tr>
<tr class="even">
<td align="left"><code>na.strings</code></td>
<td align="left">How are missing values coded?</td>
</tr>
</tbody>
</table>
<div class="rmdnote">
<p>
Remember that you can always find out more about a function by looking at its help file. For example, check out <code>?read.table</code> and <code>?read.fwf</code>. You can also use the help files to determine the default values of arguments for each function.
</p>
</div>
</div>
<div id="the-read_-functions" class="section level3">
<h3><span class="header-section-number">2.2.2</span> The <code>read_*</code> functions</h3>
<p>The <code>read.table</code> family of functions are part of base R. There is a newer package called <code>readr</code> that has a family of <code>read_*</code> functions. These functions are very similar, but have some more sensible defaults. Compared to the <code>read.table</code> family of functions, the <code>read_*</code> functions:</p>
<ul>
<li>Work better with large datasets: faster, includes progress bar</li>
<li>Have more sensible defaults (e.g., characters default to characters, not factors)</li>
</ul>
<p>Functions in the <code>read_*</code> family include:</p>
<ul>
<li><code>read_csv</code>, <code>read_tsv</code> (specific delimiters)</li>
<li><code>read_delim</code>, <code>read_table</code> (generic)</li>
<li><code>read_fwf</code></li>
<li><code>read_log</code></li>
<li><code>read_lines</code></li>
</ul>
<p>These functions work very similarly to functions from the <code>read.table</code> family. For example, to read in the Daily Show guest data, you can call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
daily_show &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/daily_show_guests.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   YEAR = col_integer(),
##   GoogleKnowlege_Occupation = col_character(),
##   Show = col_character(),
##   Group = col_character(),
##   Raw_Guest_List = col_character()
## )</code></pre>
<p>The message that R prints after this call (“Parsed with column specification:..”) lets you know what classes R used for each column (this function tries to guess the appropriate function and, unlike the <code>readr</code> functions, will assign characters to a character rather than factor class – this is usually what you want).</p>
<div class="rmdnote">
<p>
The <code>readr</code> package is a member of the tidyverse of packages. The <em>tidyverse</em> describes an evolving collection of R packages with a common philosophy, and they are unquestionably changing the way people code in R. Most were developed in part or full by Hadley Wickham and others at RStudio. Many of these packages are only a few years old, but have been rapidly adapted by the R community. As a result, newer examples of R code will often look very different from the code in older R scripts, including examples in books that are more than a few years old. In this course, I’ll focus on “tidyverse” functions when possible, but I do put in details about base R equivalent functions or processes at some points – this will help you interpret older code. You can use the <code>tidyverse</code> package to download all tidyverse packages at one.
</p>
</div>
</div>
<div id="reading-online-flat-files" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Reading online flat files</h3>
<p>So far, I’ve only shown you how to read in data from files that are saved to your computer. R can also read in data directly from the web. If a flat file is posted online, you can read it into R in almost exactly the same way that you would read in a local file. The only difference is that you will use the file’s url instead of a local file path for the <code>file</code> argument.</p>
<p>With the <code>read_*</code> family of functions, you can do this both for flat files from a non-secure webpage (i.e., one that starts with <code>http</code>) and for files from a secure webpage (i.e., one that starts with <code>https</code>), including GitHub and Dropbox.</p>
<p>For example, to read in data from this <a href="https://raw.githubusercontent.com/cmrivers/ebola/master/country_timeseries.csv">GitHub repository of Ebola data</a>, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/cmrivers/&quot;</span>,
              <span class="st">&quot;ebola/master/country_timeseries.csv&quot;</span>)
ebola &lt;-<span class="st"> </span><span class="kw">read_csv</span>(url)
ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   Date       Day Cases_Guinea
##   &lt;chr&gt;    &lt;int&gt;        &lt;int&gt;
## 1 1/5/2015   289         2776
## 2 1/4/2015   288         2775
## 3 1/3/2015   287         2769</code></pre>
</div>
<div id="saving-and-loading-r-objects" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Saving and loading R objects</h3>
<p>You can save an R object you’ve created as an <code>.RData</code> file.</p>
<p>To save an R object in a <code>.RData</code> file, use the <code>save</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(ebola, <span class="dt">file =</span> <span class="st">&quot;Ebola.RData&quot;</span>)
<span class="kw">list.files</span>()</code></pre></div>
<pre><code>##  [1] &quot;_book&quot;                         &quot;_bookdown.yml&quot;                
##  [3] &quot;_build.sh&quot;                     &quot;_deploy.sh&quot;                   
##  [5] &quot;_output.yml&quot;                   &quot;01-course_info.Rmd&quot;           
##  [7] &quot;02-prelim.Rmd&quot;                 &quot;03-databasics.Rmd&quot;            
##  [9] &quot;book.bib&quot;                      &quot;data&quot;                         
## [11] &quot;DESCRIPTION&quot;                   &quot;Ebola.RData&quot;                  
## [13] &quot;figures&quot;                       &quot;homework.Rmd&quot;                 
## [15] &quot;index.Rmd&quot;                     &quot;LICENSE&quot;                      
## [17] &quot;packages.bib&quot;                  &quot;preamble.tex&quot;                 
## [19] &quot;README.md&quot;                     &quot;references.Rmd&quot;               
## [21] &quot;RProgrammingForResearch.Rmd&quot;   &quot;RProgrammingForResearch.Rproj&quot;
## [23] &quot;slides&quot;                        &quot;style.css&quot;                    
## [25] &quot;toc.css&quot;                       &quot;vocabulary.Rmd&quot;</code></pre>
<p>Notice that, once you save the object, a new file named “Ebola.RData” is listed in the files in your current working directory. The default is for R to save the R object in your current working directory; to save it elsewhere, use a full relative or absolute pathname for the <code>file</code> argument.</p>
<p>Once you’ve saved an R object, you can re-load it later using the <code>load</code> function with the object’s file path. For example, since I’ve saved this R object, I can remove it from my current R workspace using the <code>rm</code> function, after which it will not show up when I run <code>ls</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(ebola)
<span class="kw">ls</span>()</code></pre></div>
<pre><code>## [1] &quot;ld_genetics&quot; &quot;my_dir&quot;      &quot;url&quot;</code></pre>
<p>Then I can use the <code>load</code> command to re-load the object, after which it will again show up as an object in my R workspace:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;Ebola.RData&quot;</span>)
<span class="kw">ls</span>()</code></pre></div>
<pre><code>## [1] &quot;ebola&quot;       &quot;ld_genetics&quot; &quot;my_dir&quot;      &quot;url&quot;</code></pre>
<p>There is one caveat for saving R objects: some people suggest you avoid this if possible, to make your research more reproducible (which is why we’re not covering it in the course slides). Imagine someone wants to look at your data and code in 30 years. R might not work the same way, so you might not be able to read an <code>.RData</code> file. Notice that, if you try to open an <code>.RData</code> file in a text edit, it won’t make any sense. However, you can open flat files (e.g., <code>.csv</code>, <code>.txt</code>) and R scripts (<code>.R</code>) in text editors – you should still be able to do this regardless of what happens to R. Some potential exceptions, when it might be useful to save an R object, include when:</p>
<ul>
<li>You have an object that you need to save that has a structure that won’t work well in a flat file (a list rather than a dataframe, for example); or</li>
<li>Your starting dataset is very large, and it would take a long time for you to read in your data fresh every time. In this case it may make sense to do some data cleaning and then save the cleaned R object as a <code>.RData</code> file, but be sure to also save the script you used to clean the raw data.</li>
</ul>
</div>
<div id="reading-other-file-types" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Reading other file types</h3>
<p>Later in the course, we’ll talk about how to open a variety of other file types in R. However, you might find it immediately useful to be able to read in files from other statistical programs.</p>
<p>There are two “tidyverse” packages—<code>readxl</code> and <code>haven</code>—that help with this. They allow you to read in files from the following formats:</p>
<table>
<thead>
<tr class="header">
<th align="left">File type</th>
<th align="left">Function</th>
<th align="left">Package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Excel</td>
<td align="left"><code>read_excel</code></td>
<td align="left"><code>readxl</code></td>
</tr>
<tr class="even">
<td align="left">SAS</td>
<td align="left"><code>read_sas</code></td>
<td align="left"><code>haven</code></td>
</tr>
<tr class="odd">
<td align="left">SPSS</td>
<td align="left"><code>read_spss</code></td>
<td align="left"><code>haven</code></td>
</tr>
<tr class="even">
<td align="left">Stata</td>
<td align="left">`read_stata</td>
<td align="left"><code>haven</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="directories-and-pathnames" class="section level2">
<h2><span class="header-section-number">2.3</span> Directories and pathnames</h2>
<div id="directory-structure" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Directory structure</h3>
<p>It seems a bit of a pain and a bit complex to have to think about computer directory structure in the “basics” part of this class, but this structure is not terribly complex once you get the idea of it. There are a couple of very good reasons why it’s worth learning now.</p>
<p>First, many of the most frustrating errors you get when you start using R trace back to understanding directories and filepaths. For example, when you try to read a file into R using only the filename, and that file is not in your current working directory, you will get an error like:</p>
<pre><code>Error in file(file, &quot;rt&quot;) : cannot open the connection
In addition: Warning message:
In file(file, &quot;rt&quot;) : cannot open file &#39;Ex.csv&#39;: No such file or directory</code></pre>
<p>This error is especially frustrating when you’re new to R because it happens at the very beginning of your analysis – you can’t even get your data in. Also, if you don’t understand a bit about working directories and how R looks for the file you’re asking it to find, you’d have no idea where to start to fix this error.</p>
<p>Second, once you understand how to use pathnames, especially relative pathnames, to tell R how to find a file that is in a directory other than your working directory, you will be able to organize all of your files for a project in a much cleaner way. For example, you can create a directory for your project, then create one subdirectory to store all of your R scripts, and another to store all of your data, and so on. This can help you keep very complex projects more structured and easier to navigate. We’ll talk about these ideas more in the course sections on Reproducible Research, but it’s good to start learning how directory structures and filepaths work early.</p>
<p>Your computer organizes files through a collection of directories. Chances are, you are fairly used to working with these in your daily life already (although you may call them “folders” rather than “directories”). For example, you’ve probably created new directories to store data files and Word documents for a specific project.</p>
<p>Figure <a href="entering-and-cleaning-data-1.html#fig:filedirstructure">2.1</a> illustrates the file directory structure on my computer. (Note that I have omitted many, many additional files and directories – this just shows an example of a few directories and files and how they are structured together). Directories are shown in blue, and files in green.</p>
<div class="figure" style="text-align: center"><span id="fig:filedirstructure"></span>
<img src="figures/FileDirectoryStructure.png" alt="An example of file directory structure." width="600pt" />
<p class="caption">
Figure 2.1: An example of file directory structure.
</p>
</div>
<p>You can notice a few interesting things from Figure <a href="entering-and-cleaning-data-1.html#fig:filedirstructure">2.1</a>. First, you might notice the structure includes a few of the directories that you use a lot on your own computer, like <code>Desktop</code>, <code>Documents</code>, and <code>Downloads</code>. Next, the directory at the very top is the computer’s root directory, <code>/</code>. For a PC, the root directory might something like <code>C:</code>; for Unix and Macs, it’s usually <code>/</code>. Finally, if you look closely, you’ll notice that it’s possible to have different files in different locations of the directory structure with the same file name. For example, in the figure, there are files names <code>heat_mort.csv</code> in both the <code>CourseText</code> directory and in the <code>example_data</code> directory. These are two different files with different contents, but they can have the same name as long as they’re in different directories. This fact – that you can have files with the same name in different places – should help you appreciate how useful it is that R requires you to give very clear directions to describe exactly which file you want R to read in, if you aren’t reading in something in your current working directory.</p>
<p>You will have a home directory somewhere near the top of your structure, although it’s likely not your root directory. My home directory is <code>/Users/brookeanderson</code>. I’ll describe just a bit later how you can figure out what your own home directory is on your own computer.</p>
</div>
<div id="working-directory" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Working directory</h3>
<p>When you run R, it’s always running from within some working directory, which will be one of the directories somewhere in your computer’s directory structure. At any time, you can figure out which directory R is working in by running the command <code>getwd()</code> (short for “get working directory”). For example, my R session is currently running in the following directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<pre><code>## [1] &quot;/Users/_gbanders/r_course/RProgrammingForResearch&quot;</code></pre>
<p>This means that, for my current R session, R is working in the <code>RProgrammingForResearch</code> subdirectory of my <code>brookeanderson</code> directory (which is my home directory).</p>
<p>There are a few general rules for which working directory R will start in when you open an R session. These are not absolute rules, but they’re generally true. If you have R closed, and you open it by double-clicking on an R script, then R will generally open with, as its working directory, the directory in which that script is stored. This is often a very convenient convention, because often any of the data you’ll be reading in for that script is somewhere near where the script file is saved in the directory structure.</p>
<p>If you open R by double-clicking on the R icon in “Applications” (or something similar on a PC), R will start in its default working directory. You can find out what this is, or change it, in RStudio’s “Preferences”. I have never had a compelling reason to change this on my own computer, as I find it very easy to just move around the directories and set a new working directory using pathnames and the <code>setwd()</code> function.</p>
<p>Finally, later in the course, we’ll talk about using R Projects from within RStudio. If you open an R Project, R will start in that project’s working directory (the directory in which the <code>.Rproj</code> file for the project is stored).</p>
</div>
<div id="file-and-directory-pathnames" class="section level3">
<h3><span class="header-section-number">2.3.3</span> File and directory pathnames</h3>
<p>Once you get a picture of how your directories and files are organized, you can use pathnames, either absolute or relative, to move around the directories, set a different working directory, and read in files from different directories than your current working directory. Pathnames are the directions for getting to a directory or file stored on your computer.</p>
<p>When you want to reference a directory or file, you can use one of two types of pathnames:</p>
<ul>
<li><em>Relative pathname</em>: How to get to the file or directory from your current working directory</li>
<li><em>Absolute pathname</em>: How to get to the file or directory from anywhere on the computer</li>
</ul>
<p>Absolute pathnames are a bit more straightforward conceptually, because they don’t depend on your current working directory. However, they’re also a lot longer to write, and they’re much less convenient if you’ll be sharing some of your code with other people who might run it on their own computers. I’ll explain this second point a bit more later in this section.</p>
<p><em>Absolute pathnames</em> give the full directions to a directory or file, starting all the way at the root directory. For example, the <code>heat_mort.csv</code> file in the <code>CourseText</code> directory has the absolute pathname:</p>
<pre><code>&quot;/Users/brookeanderson/Desktop/RCourseFall2015/CourseText/heat_mort.csv&quot;</code></pre>
<p>You can use this absolute pathname to read this file in using <code>read.csv</code>. This absolute pathname will <em>always</em> work, regardless of your current working directory, because it gives directions from the root – it will always be clear to R exactly what file you’re talking about. Here’s the code to use to read that file in using the <code>read.csv</code> function with the file’s absolute pathname:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heat_mort &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/Users/brookeanderson/Desktop/RCourseFall2015/CourseText/heat_mort.csv&quot;</span>)</code></pre></div>
<p>The <em>relative pathname</em>, on the other hand, gives R the directions for how to get to a directory or file from the current working directory. If the file or directory you’re looking for is pretty close to your current working directory in your directory structure, then a relative pathname can be a much shorter way to tell R how to get to the file than an absolute pathname. However, the relative pathname depends on your current working directory – the relative pathname that works perfectly when you’re working in one directory will not work at all once you move into a different working directory.</p>
<p>As an example of a relative pathname, say you’re working in the directory <code>RCourseFall2015</code> within the file structure shown in Figure <a href="entering-and-cleaning-data-1.html#fig:filedirstructure">2.1</a>, and you want to read in the <code>heat_mort.csv</code> file in the <code>CourseText</code> directory. To get from <code>RCourseFall2015</code> to that file, you’d need to look in the subdirectory <code>CourseText</code>, where you could find <code>heat_mort.csv</code>. Therefore, the relative pathname from your working directory would be:</p>
<pre><code>&quot;CourseText/heat_mort.csv&quot;</code></pre>
<p>You can use this relative pathname to tell R where to find and read in the file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heat_mort &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseText/heat_mort.csv&quot;</span>)</code></pre></div>
<p>While this pathname is much shorter than the absolute pathname, it is important to remember that if you changed your working directory (for example, if you used <code>setwd(&quot;CourseText&quot;)</code> to move into the <code>CourseText</code> directory), this relative pathname would no longer work.</p>
<p>There are a few abbreviations that can be really useful for pathnames:</p>
<table>
<thead>
<tr class="header">
<th align="left">Shorthand</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>~</code></td>
<td align="left">Home directory</td>
</tr>
<tr class="even">
<td align="left"><code>.</code></td>
<td align="left">Current working directory</td>
</tr>
<tr class="odd">
<td align="left"><code>..</code></td>
<td align="left">One directory up from current working directory</td>
</tr>
<tr class="even">
<td align="left"><code>../..</code></td>
<td align="left">Two directories up from current working directory</td>
</tr>
</tbody>
</table>
<p>These can help you keep pathnames shorter and also help you move “up-and-over” to get to a file or directory that’s not on the direct path below your current working directory.</p>
<p>For example, my home directory is <code>/Users/brookeanderson</code>. If I wanted to change my working directory to the <code>Downloads</code> directory, which is a direct sub-directory of my home directory, I could use:</p>
<pre><code>setwd(&quot;~/Downloads&quot;)</code></pre>
<p>As a second example, say I was working in the working directory <code>CourseText</code>, but I wanted to read in the <code>heat_mort.csv</code> file that’s in the <code>example_data</code> directory, rather than the one in the <code>CourseText</code> directory. I can use the <code>..</code> abbreviation to tell R to look up one directory from the current working directory, and then down within a subdirectory of that. The relative pathname in this case is:</p>
<pre><code>&quot;../Week2_Aug31/example_data/heat_mort.csv&quot;</code></pre>
<p>This tells R to look one directory up from the working directory (<code>..</code>), which in this case is to <code>RCourseFall2015</code>, and then down within that directory to <code>Week2_Aug31</code>, then to <code>example_data</code>, and then to look there for the file <code>heat_mort.csv</code>.</p>
<p>The relative pathname to read this file while R is working in the <code>CourseTest</code> directory would be:</p>
<pre><code>heat_mort &lt;- read.csv(&quot;../Week2_Aug31/example_data/heat_mort.csv&quot;)</code></pre>
<p>These relative pathnames would “break” as soon as you tried them from a different working directory – this fact might make it seem like you would never want to use relative pathnames, and would always want to use absolute ones instead, even if they’re longer. If that were the only consideration (length of the pathname), then perhaps that would be true. However, as you do more and more in R, there will likely be many occasions when you want to use relative pathnames instead. They are particularly useful if you ever want to share a whole directory, with R scripts and data, with a collaborator. In that case, if you’ve used relative pathnames, all the code should work fine for the person you share with, even though they’re running it on their own computer. Conversely, if you’d used absolute pathnames, none of them would work on another computer, because the “top” of the directory structure (i.e., for me, <code>/Users/brookeanderson/Desktop</code>) will almost definitely be different for your collaborator’s computer than it is for yours.</p>
<p>You can use absolute or relative pathnames for a number of things:</p>
<ul>
<li>To set your working directory: <code>setwd(&quot;../Week2_Aug31&quot;)</code>, for example</li>
<li>To read in files from a different directory (as shown in the previous examples)</li>
<li>To list files in a different directory: for example, <code>list.files(&quot;..&quot;)</code> will list all files in the directory directly about your current working directory (the <em>parent directory</em> of your working directory)</li>
</ul>
<p>If you’re getting errors reading in files, and you think it’s related to the relative pathname you’re using, it’s often helpful to use <code>list.files()</code> to make sure the file you’re trying to load is in the directory that the relative pathname you’re using is directing R to.</p>
</div>
</div>
<div id="diversion-paste" class="section level2">
<h2><span class="header-section-number">2.4</span> Diversion: <code>paste</code></h2>
<p>This is a good opportunity to explain how to use some functions that can be very helpful when you’re using relative or absolute pathnames: <code>paste()</code> and <code>paste0()</code>.</p>
<p>As a bit of important background information, it’s important that you understand that you can save a pathname (absolute or relative) as an R object, and then use that R object in calls to later functions like <code>list.files()</code> and <code>read.csv()</code>. For example, to use the absolute pathname to read the <code>heat_mort.csv</code> file in the <code>CourseText</code> directory, you could run:</p>
<pre><code>my_file &lt;- &quot;/Users/brookeanderson/Desktop/RCourseFall2015/CourseText/heat_mort.csv&quot;
heat_mort &lt;- read.csv(my_file)</code></pre>
<p>You’ll notice from this code that the pathname to get to a directory or file can sometimes become ungainly and long. To keep your code cleaner, you can address this by using the <code>paste</code> or <code>paste0</code> functions. These functions come in handy in a lot of other applications, too, but this is a good place to introduce them.</p>
<p>The <code>paste()</code> function is very straightforward. It takes, as inputs, a series of different character strings you want to join together, and it pastes them together in a single character string. (As a note, this means that your result vector will only be one element long, for basic uses of <code>paste()</code>, while the inputs will be several different character stings.) You separate all the different things you want to paste together using with commas in the function call. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Sunday Monday Tuesday&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">c</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>))</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">paste</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>The <code>paste()</code> function has an option called <code>sep =</code>. This tells R what you want to use to separate the values you’re pasting together in the output. The default is for R to use a space, as shown in the example above. To change the separator, you can change this option, and you can put in just about anything you want. For example, if you wanted to paste all the values together without spaces, you could use <code>sep = &quot;&quot;</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;SundayMondayTuesday&quot;</code></pre>
<p>As a shortcut, instead of using the <code>sep = &quot;&quot;</code> option, you could achieve the same thing using the <code>paste0</code> function. This function is almost exactly like <code>paste</code>, but it defaults to <code>&quot;&quot;</code> (i.e., no space) as the separator between values by default:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste0</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;SundayMondayTuesday&quot;</code></pre>
<p>With pathnames, you will usually not want spaces. Therefore, you could think about using <code>paste0()</code> to write an object with the pathname you want to ultimately use in commands like <code>list.files()</code> and <code>setwd()</code>. This will allow you to keep your code cleaner, since you can now divide long pathnames over multiple lines:</p>
<pre><code>my_file &lt;- paste0(&quot;/Users/brookeanderson/Desktop/&quot;,
                  &quot;RCourseFall2015/CourseText/heat_mort.csv&quot;)
heat_mort &lt;- read.csv(my_file)</code></pre>
<p>You will end up using <code>paste()</code> and <code>paste0()</code> for many other applications, but this is a good example of how you can start using these functions to start to get a feel for them.</p>
</div>
<div id="data-cleaning" class="section level2">
<h2><span class="header-section-number">2.5</span> Data cleaning</h2>
<p>Once you have loaded data into R, you’ll likely need to clean it up a little before you’re ready to analyze it. Here, I’ll go over the first steps of how to do that with functions from <code>dplyr</code>, another package in the tidyverse. Here are some of the most common data-cleaning tasks, along with the corresponding <code>dplyr</code> function for each:</p>
<table>
<thead>
<tr class="header">
<th align="left">Task</th>
<th align="left"><code>dplyr</code> function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Renaming columns</td>
<td align="left"><code>rename</code></td>
</tr>
<tr class="even">
<td align="left">Filtering to certain rows</td>
<td align="left"><code>filter</code></td>
</tr>
<tr class="odd">
<td align="left">Selecting certain columns</td>
<td align="left"><code>select</code></td>
</tr>
<tr class="even">
<td align="left">Adding or changing columns</td>
<td align="left"><code>mutate</code></td>
</tr>
</tbody>
</table>
<p>In this section, I’ll describe how to do each of these four tasks; in later sections of the course, we’ll go much deeper into how to clean messier data.</p>
<p>For the examples in this section, I’ll use example data listing guests to the Daily Show. To follow along with these examples, you’ll want to load that data, as well as load the <code>dplyr</code> package (install it using <code>install.packages</code> if you have not already):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
daily_show &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/daily_show_guests.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">4</span>)</code></pre></div>
<p>I’ve used this data in previous examples, but as a reminder, here’s what it looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(daily_show)</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    YEAR GoogleKnowlege_Occupation Show    Group  Raw_Guest_List  
##   &lt;int&gt; &lt;chr&gt;                     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;           
## 1  1999 actor                     1/11/99 Acting Michael J. Fox  
## 2  1999 Comedian                  1/12/99 Comedy Sandra Bernhard 
## 3  1999 television actress        1/13/99 Acting Tracey Ullman   
## 4  1999 film actress              1/14/99 Acting Gillian Anderson
## 5  1999 actor                     1/18/99 Acting David Alan Grier
## 6  1999 actor                     1/19/99 Acting William Baldwin</code></pre>
<div id="renaming-columns" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Renaming columns</h3>
<p>A first step is often re-naming the columns of the dataframe. It can be hard to work with a column name that:</p>
<ul>
<li>is long</li>
<li>includes spaces</li>
<li>includes upper case</li>
</ul>
<p>You can check out the column names for a dataframe using the <code>colnames</code> function, with the dataframe object as the argument. Several of the column names in <code>daily_show</code> have some of these issues:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(daily_show)</code></pre></div>
<pre><code>## [1] &quot;YEAR&quot;                      &quot;GoogleKnowlege_Occupation&quot;
## [3] &quot;Show&quot;                      &quot;Group&quot;                    
## [5] &quot;Raw_Guest_List&quot;</code></pre>
<p>To rename these columns, use <code>rename</code>. The basic syntax is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
<span class="kw">rename</span>(dataframe, 
       <span class="dt">new_column_name_1 =</span> old_column_name_<span class="dv">1</span>,
       <span class="dt">new_column_name_2 =</span> old_column_name_<span class="dv">2</span>)</code></pre></div>
<p>The first argument is the dataframe for which you’d like to rename columns. Then you list each pair of new versus old column names (in that order) for each of the columns you want to rename. To rename columns in the <code>daily_show</code> data using <code>rename</code>, for example, you would run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="st"> </span><span class="kw">rename</span>(daily_show,
                     <span class="dt">year =</span> YEAR,
                     <span class="dt">job =</span> GoogleKnowlege_Occupation, 
                     <span class="dt">date =</span> Show, 
                     <span class="dt">category =</span> Group,
                     <span class="dt">guest_name =</span> Raw_Guest_List)
<span class="kw">head</span>(daily_show, <span class="dv">3</span>)</code></pre></div>
<pre><code>## # A tibble: 3 x 5
##    year job                date    category guest_name     
##   &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;          
## 1  1999 actor              1/11/99 Acting   Michael J. Fox 
## 2  1999 Comedian           1/12/99 Comedy   Sandra Bernhard
## 3  1999 television actress 1/13/99 Acting   Tracey Ullman</code></pre>
<div class="rmdwarning">
<p>
Many of the functions in tidyverse packages, including those in <code>dplyr</code>, provide exceptions to the general rule about when to use quotation marks versus when to leave them off. Unfortunately, this may make it a bit hard to learn when to use quotation marks versus when not to. One way to think about this, which is a bit of an oversimplification but can help as you’re learning, is to assume that anytime you’re using a <code>dplyr</code> function, every column in the dataframe you’re working with has been loaded to your R session as its own object.
</p>
</div>
</div>
<div id="selecting-columns" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Selecting columns</h3>
<p>Next, you may want to select only some columns of the dataframe. You can use the <code>select</code> function from <code>dplyr</code> to subset the dataframe to certain columns. The basic structure of this command is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
<span class="kw">select</span>(dataframe, column_name_<span class="dv">1</span>, column_name_<span class="dv">2</span>, ...)</code></pre></div>
<p>In this call, you first specify the dataframe to use and then list all of the column names to include in the output dataframe, with commas between each column name. For example, to select all columns in <code>daily_show</code> except <code>year</code> (since that information is already included in <code>date</code>), run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(daily_show, job, date, category, guest_name)</code></pre></div>
<pre><code>## # A tibble: 2,693 x 4
##    job                date    category guest_name      
##    &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;           
##  1 actor              1/11/99 Acting   Michael J. Fox  
##  2 Comedian           1/12/99 Comedy   Sandra Bernhard 
##  3 television actress 1/13/99 Acting   Tracey Ullman   
##  4 film actress       1/14/99 Acting   Gillian Anderson
##  5 actor              1/18/99 Acting   David Alan Grier
##  6 actor              1/19/99 Acting   William Baldwin 
##  7 Singer-lyricist    1/20/99 Musician Michael Stipe   
##  8 model              1/21/99 Media    Carmen Electra  
##  9 actor              1/25/99 Acting   Matthew Lillard 
## 10 stand-up comedian  1/26/99 Comedy   David Cross     
## # ... with 2,683 more rows</code></pre>
<div class="rmdwarning">
<p>
Don’t forget that, if you want to change column names in the saved object, you must reassign the object to be the output of <code>rename</code>. If you run one of these cleaning functions without reassigning the object, R will print out the result, but the object itself won’t change. You can take advantage of this, as I’ve done in this example, to look at the result of applying a function to a dataframe without changing the original dataframe. This can be helpful as you’re figuring out how to write your code.
</p>
</div>
<p>The <code>select</code> function also provides some time-saving tools. For example, in the last example, we wanted all the columns except one. Instead of writing out all the columns we want, we can use <code>-</code> with the columns we don’t want to save time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="st"> </span><span class="kw">select</span>(daily_show, <span class="op">-</span>year)
<span class="kw">head</span>(daily_show, <span class="dv">3</span>)</code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   job                date    category guest_name     
##   &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;          
## 1 actor              1/11/99 Acting   Michael J. Fox 
## 2 Comedian           1/12/99 Comedy   Sandra Bernhard
## 3 television actress 1/13/99 Acting   Tracey Ullman</code></pre>
</div>
<div id="filtering-to-certain-rows" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Filtering to certain rows</h3>
<p>Next, you might want to filter the dataset down so that it only includes certain rows. For example, you might want to get a dataset with only the guests from 2015, or only guests who are scientists.</p>
<p>You can use the <code>filter</code> function from <code>dplyr</code> to filter a dataframe down to a subset of rows. The syntax is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
<span class="kw">filter</span>(dataframe, logical statement)</code></pre></div>
<p>The <code>logical statement</code> in this call gives the condition that a row must meet to be included in the output data frame. For example, if you want to create a data frame that only includes guests who were scientists, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scientists &lt;-<span class="st"> </span><span class="kw">filter</span>(daily_show, category <span class="op">==</span><span class="st"> &quot;Science&quot;</span>)
<span class="kw">head</span>(scientists)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   job            date    category guest_name            
##   &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;                 
## 1 neurosurgeon   4/28/03 Science  Dr Sanjay Gupta       
## 2 scientist      1/13/04 Science  Catherine Weitz       
## 3 physician      6/15/04 Science  Hassan Ibrahim        
## 4 doctor         9/6/05  Science  Dr. Marc Siegel       
## 5 astronaut      2/13/06 Science  Astronaut Mike Mullane
## 6 Astrophysicist 1/30/07 Science  Neil deGrasse Tyson</code></pre>
<p>To build a logical statement to use in <code>filter</code>, you’ll need to know some of R’s logical operators. Some of the most commonly used ones are:</p>
<table>
<thead>
<tr class="header">
<th>Operator</th>
<th>Meaning</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>equals</td>
<td><code>category == &quot;Acting&quot;</code></td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td>does not equal</td>
<td><code>category != &quot;Comedy</code></td>
</tr>
<tr class="odd">
<td><code>%in%</code></td>
<td>is in</td>
<td><code>category %in% c(&quot;Academic&quot;, &quot;Science&quot;)</code></td>
</tr>
<tr class="even">
<td><code>is.na()</code></td>
<td>is NA</td>
<td><code>is.na(job)</code></td>
</tr>
<tr class="odd">
<td><code>!is.na()</code></td>
<td>is not NA</td>
<td><code>!is.na(job)</code></td>
</tr>
<tr class="even">
<td><code>&amp;</code></td>
<td>and</td>
<td><code>year == 2015 &amp; category == &quot;Academic&quot;</code></td>
</tr>
<tr class="odd">
<td><code>|</code></td>
<td>or</td>
<td><code>year == 2015 | category == &quot;Academic&quot;</code></td>
</tr>
</tbody>
</table>
<p>We’ll use these logical operators a lot more as the course continues, so they’re worth learning by heart.</p>
<div class="rmdwarning">
<p>
Two common errors with logical operators are: (1) Using <code>=</code> instead of <code>==</code> to check if two values are equal; and (2) Using <code>== NA</code> instead of <code>is.na</code> to check for missing observations.
</p>
</div>
</div>
<div id="add-or-change-columns" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Add or change columns</h3>
<p>You can change a column or add a new column using the <code>mutate</code> function from the <code>dplyr</code> package. That function has the syntax:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generic code</span>
<span class="kw">mutate</span>(dataframe,
       <span class="dt">changed_column =</span> <span class="cf">function</span>(changed_column),
       <span class="dt">new_column =</span> <span class="cf">function</span>(other arguments))</code></pre></div>
<p>For example, the <code>job</code> column in <code>daily_show</code> sometimes uses upper case and sometimes does not (this call uses the <code>unique</code> function to list only unique values in this column):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">unique</span>(daily_show<span class="op">$</span>job), <span class="dv">10</span>)</code></pre></div>
<pre><code>##  [1] &quot;actor&quot;              &quot;Comedian&quot;           &quot;television actress&quot;
##  [4] &quot;film actress&quot;       &quot;Singer-lyricist&quot;    &quot;model&quot;             
##  [7] &quot;stand-up comedian&quot;  &quot;actress&quot;            &quot;comedian&quot;          
## [10] &quot;Singer-songwriter&quot;</code></pre>
<p>To make all the observations in the <code>job</code> column lowercase, use the <code>tolower</code> function within a <code>mutate</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(daily_show, <span class="dt">job =</span> <span class="kw">tolower</span>(job))</code></pre></div>
<pre><code>## # A tibble: 2,693 x 4
##    job                date    category guest_name      
##    &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;           
##  1 actor              1/11/99 Acting   Michael J. Fox  
##  2 comedian           1/12/99 Comedy   Sandra Bernhard 
##  3 television actress 1/13/99 Acting   Tracey Ullman   
##  4 film actress       1/14/99 Acting   Gillian Anderson
##  5 actor              1/18/99 Acting   David Alan Grier
##  6 actor              1/19/99 Acting   William Baldwin 
##  7 singer-lyricist    1/20/99 Musician Michael Stipe   
##  8 model              1/21/99 Media    Carmen Electra  
##  9 actor              1/25/99 Acting   Matthew Lillard 
## 10 stand-up comedian  1/26/99 Comedy   David Cross     
## # ... with 2,683 more rows</code></pre>
</div>
<div id="piping" class="section level3">
<h3><span class="header-section-number">2.5.5</span> Piping</h3>
<p>So far, I’ve shown how to use these <code>dplyr</code> functions one at a time to clean up the data, reassigning the dataframe object at each step. However, there’s a trick called “piping” that will let you clean up your code a bit when you’re writing a script to clean data.</p>
<p>If you look at the format of these <code>dplyr</code> functions, you’ll notice that they all take a dataframe as their first argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generic code</span>
<span class="kw">rename</span>(dataframe, 
       <span class="dt">new_column_name_1 =</span> old_column_name_<span class="dv">1</span>,
       <span class="dt">new_column_name_2 =</span> old_column_name_<span class="dv">2</span>)
<span class="kw">select</span>(dataframe, column_name_<span class="dv">1</span>, column_name_<span class="dv">2</span>)
<span class="kw">filter</span>(dataframe, logical statement)
<span class="kw">mutate</span>(dataframe,
       <span class="dt">changed_column =</span> <span class="cf">function</span>(changed_column),
       <span class="dt">new_column =</span> <span class="cf">function</span>(other arguments))</code></pre></div>
<p>Without piping, you have to reassign the dataframe object at each step of this cleaning if you want the changes saved in the object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="kw">read_csv</span>(<span class="st">&quot;data/daily_show_guests.csv&quot;</span>,
                      <span class="dt">skip =</span> <span class="dv">4</span>)
daily_show &lt;-<span class="st"> </span><span class="kw">rename</span>(daily_show, 
                     <span class="dt">job =</span> GoogleKnowlege_Occupation,
                     <span class="dt">date =</span> Show,
                     <span class="dt">category =</span> Group,
                     <span class="dt">guest_name =</span> Raw_Guest_List)
daily_show &lt;-<span class="st"> </span><span class="kw">select</span>(daily_show, <span class="op">-</span>YEAR) 
daily_show &lt;-<span class="st"> </span><span class="kw">mutate</span>(daily_show, <span class="dt">job =</span> <span class="kw">tolower</span>(job))
daily_show &lt;-<span class="st"> </span><span class="kw">filter</span>(daily_show, category <span class="op">==</span><span class="st"> &quot;Science&quot;</span>)</code></pre></div>
<p>Piping lets you clean this code up a bit. It can be used with any function that inputs a dataframe as its first argument. It <em>pipes</em> the dataframe created right before the pipe (<code>%&gt;%</code>) into the function right after the pipe. With piping, therefore, the same data cleaning looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="kw">read_csv</span>(<span class="st">&quot;data/daily_show_guests.csv&quot;</span>,
                      <span class="dt">skip =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">job =</span> GoogleKnowlege_Occupation,
         <span class="dt">date =</span> Show,
         <span class="dt">category =</span> Group,
         <span class="dt">guest_name =</span> Raw_Guest_List) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>YEAR) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">job =</span> <span class="kw">tolower</span>(job)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> &quot;Science&quot;</span>)</code></pre></div>
<p>Notice that, when piping, the first argument (the name of the dataframe) is excluded from all function calls that follow a pipe. This is because piping sends the dataframe from the last step into each of these functions as the dataframe argument.</p>
</div>
<div id="base-r-equivalents-to-dplyr-functions" class="section level3">
<h3><span class="header-section-number">2.5.6</span> Base R equivalents to <code>dplyr</code> functions</h3>
<p>Just so you know, all of these <code>dplyr</code> functions have alternatives, either functions or processes, in base R:</p>
<table>
<thead>
<tr class="header">
<th align="left"><code>dplyr</code></th>
<th align="left">Base R equivalent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rename</code></td>
<td align="left">Reassign <code>colnames</code></td>
</tr>
<tr class="even">
<td align="left"><code>select</code></td>
<td align="left">Square bracket indexing</td>
</tr>
<tr class="odd">
<td align="left"><code>filter</code></td>
<td align="left"><code>subset</code></td>
</tr>
<tr class="even">
<td align="left"><code>mutate</code></td>
<td align="left">Use <code>$</code> to change / create columns</td>
</tr>
</tbody>
</table>
<p>You will see these alternatives used in older code examples.</p>
</div>
</div>
<div id="dates-in-r" class="section level2">
<h2><span class="header-section-number">2.6</span> Dates in R</h2>
<p>As part of the data cleaning process, you may want to change the class of some of the columns in the dataframe. For example, you may want to change a column from a character to a date.</p>
<p>Here are some of the most common vector classes in R:</p>
<table>
<thead>
<tr class="header">
<th>Class</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>character</code></td>
<td>“Chemistry”, “Physics”, “Mathematics”</td>
</tr>
<tr class="even">
<td><code>numeric</code></td>
<td>10, 20, 30, 40</td>
</tr>
<tr class="odd">
<td><code>factor</code></td>
<td>Male [underlying number: 1], Female [2]</td>
</tr>
<tr class="even">
<td><code>Date</code></td>
<td>“2010-01-01” [underlying number: 14,610]</td>
</tr>
<tr class="odd">
<td><code>logical</code></td>
<td>TRUE, FALSE</td>
</tr>
</tbody>
</table>
<p>To find out the class of a vector (including a column in a dataframe – remember each column can be thought of as a vector), you can use <code>class()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(daily_show<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>It is especially common to need to convert dates during the data cleaning process, since date columns will usually be read into R as characters or factors – you can do some interesting things with vectors that are in a Date class that you cannot do with a vector in a character class. To convert a vector to the <code>Date</code> class, you can use the <code>as.Date</code> function. For example, to convert the <code>date</code> column in the <code>daily_show</code> data into a Date class, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="st"> </span><span class="kw">mutate</span>(daily_show,
                     <span class="dt">date =</span> <span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%m/%d/%y&quot;</span>))
<span class="kw">head</span>(daily_show, <span class="dv">3</span>)</code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   job          date       category guest_name     
##   &lt;chr&gt;        &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;          
## 1 neurosurgeon 2003-04-28 Science  Dr Sanjay Gupta
## 2 scientist    2004-01-13 Science  Catherine Weitz
## 3 physician    2004-06-15 Science  Hassan Ibrahim</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(daily_show<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>Once you have an object in the <code>Date</code> class, you can do things like plot by date, calculate the range of dates, and calculate the total number of days the dataset covers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(daily_show<span class="op">$</span>date)
<span class="kw">diff</span>(<span class="kw">range</span>(daily_show<span class="op">$</span>date))</code></pre></div>
<p>You can convert dates expressed in a number of different ways into a Date class in R, as long as you can explain to R how to parse the format that the date is in before you convert it. The only tricky thing in converting objects into a Date class is learning the abbreviations for the <code>format</code> option of the <code>as.Date</code> function. Here are some common ones:</p>
<table>
<thead>
<tr class="header">
<th>Abbreviation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%m</code></td>
<td>Month as a number (e.g., 1, 05)</td>
</tr>
<tr class="even">
<td><code>%B</code></td>
<td>Full month name (e.g., August)</td>
</tr>
<tr class="odd">
<td><code>%b</code></td>
<td>Abbreviated month name (e.g., Aug)</td>
</tr>
<tr class="even">
<td><code>%y</code></td>
<td>Two-digit year (e.g., 99)</td>
</tr>
<tr class="odd">
<td><code>%Y</code></td>
<td>Four-digit year (e.g., 1999)</td>
</tr>
<tr class="even">
<td><code>%A</code></td>
<td>Full weekday (e.g., Monday)</td>
</tr>
<tr class="odd">
<td><code>%a</code></td>
<td>Abberviated weekday (e.g., Mon)</td>
</tr>
</tbody>
</table>
<p>Here are some examples of what you would specify for the <code>format</code> argument of <code>as.Date</code> for some different original formats of date columns:</p>
<table>
<thead>
<tr class="header">
<th>Your date</th>
<th><code>format</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10/23/2008</td>
<td>“%m/%d%Y”</td>
</tr>
<tr class="even">
<td>08-10-23</td>
<td>“%y-%m-%d”</td>
</tr>
<tr class="odd">
<td>Oct. 23 2008</td>
<td>“%b. %d %Y”</td>
</tr>
<tr class="even">
<td>October 23, 2008</td>
<td>“%B %d, %Y”</td>
</tr>
<tr class="odd">
<td>Thurs, 23 October 2008</td>
<td>“%a, %d %B %Y”</td>
</tr>
</tbody>
</table>
<div class="rmdwarning">
<p>
You must use the <code>format</code> argument to specify what your date column looks like <strong>before</strong> it’s converted to a Date class, not how you’d like it to look after its converted. Once an objects is in a date class, it will always be printed out using a common format, unless you change it back into a character class. (Confusingly, there is a <code>format</code> function that you can use to convert from a Date class to a character class and, in that case, the <code>format</code> argument does specify how the final date will look. This is mainly useful as a last step in data analysis, when you’re creating plot labels of table columns, for example.)
</p>
</div>
<p>There is also a function in the tidyverse, called <code>lubridate</code>, that helps in parsing dates. In many cases you can use functions from this package to parse dates much more easily, without having to specify specific starting formats.</p>
<p>The <code>ymd</code> function from lubridate can be used to parse a column into a Date class, regardless of the original format of the date, as long as the date elements are in the order: year, month, day. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)</code></pre></div>
<pre><code>## Warning: package &#39;lubridate&#39; was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ymd</span>(<span class="st">&quot;2008-10-13&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;2008-10-13&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ymd</span>(<span class="st">&quot;&#39;08 Oct 13&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;2008-10-13&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ymd</span>(<span class="st">&quot;&#39;08 Oct 13&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;2008-10-13&quot;</code></pre>
<p>The <code>lubridate</code> package has similar functions for other date orders or for date-times, including:</p>
<ul>
<li><code>dmy</code></li>
<li><code>mdy</code></li>
<li><code>ymd_h</code></li>
<li><code>ymd_hm</code></li>
</ul>
<p>We could have used these to transform the date in <code>daily_show</code>, using the following pipe chain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">daily_show &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/daily_show_guests.csv&quot;</span>,
                       <span class="dt">skip =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">job =</span> GoogleKnowlege_Occupation, 
         <span class="dt">date =</span> Show,
         <span class="dt">category =</span> Group,
         <span class="dt">guest_name =</span> Raw_Guest_List) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>YEAR) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">mdy</span>(date)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> &quot;Science&quot;</span>)
<span class="kw">head</span>(daily_show, <span class="dv">2</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   job          date       category guest_name     
##   &lt;chr&gt;        &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;          
## 1 neurosurgeon 2003-04-28 Science  Dr Sanjay Gupta
## 2 scientist    2004-01-13 Science  Catherine Weitz</code></pre>
<p>The <code>lubridate</code> package also includes functions to pull out certain elements of a date, including:</p>
<ul>
<li><code>wday</code></li>
<li><code>mday</code></li>
<li><code>yday</code></li>
<li><code>month</code></li>
<li><code>quarter</code></li>
<li><code>year</code></li>
</ul>
<p>For example, we could use <code>wday</code> to create a new column with the weekday of each show:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(daily_show,
       <span class="dt">show_day =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(date, show_day, guest_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   date       show_day guest_name            
##   &lt;date&gt;     &lt;ord&gt;    &lt;chr&gt;                 
## 1 2003-04-28 Mon      Dr Sanjay Gupta       
## 2 2004-01-13 Tue      Catherine Weitz       
## 3 2004-06-15 Tue      Hassan Ibrahim        
## 4 2005-09-06 Tue      Dr. Marc Siegel       
## 5 2006-02-13 Mon      Astronaut Mike Mullane</code></pre>
</div>
<div id="in-course-exercise-1" class="section level2">
<h2><span class="header-section-number">2.7</span> In-course Exercise</h2>
<div id="downloading-and-checking-out-the-example-data" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Downloading and checking out the example data</h3>
<p>Download the whole directory for this week from Github (<a href="https://github.com/geanders/week_2_data" class="uri">https://github.com/geanders/week_2_data</a>). To do that, go the the <a href="https://github.com/geanders/week_2_data">GitHub page with data for this week’s exercise</a> and, in the top right, choose “Clone or Download” and then choose “Download ZIP”. This will download a compressed file with the full directory of data, probably to your computer’s “Downloads” folder. Then move the directory into your course Project directory and “unzip” it (try double-clicking the file, or right click on the file and see if there’s a “decompress” or “unzip” option). All the files will be in a subdirectory—move them into the main Project directory (don’t do this in R, just use whatever technique you usually use on your computer to move files between directories).</p>
<ul>
<li>Look through the structure of the “data” directory. What files are in the directory? Which files are <strong>flat files</strong>? Which are <strong>delimited</strong> (one category of flat files), and what are their delimiters?</li>
<li>Create a new R script to put all the code you use for this exercise. Create a subdirectory in your course directory called “R” and save this script there using a <code>.R</code> extension (e.g., “week_2.R”).</li>
</ul>
</div>
<div id="reading-in-different-types-of-files" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Reading in different types of files</h3>
<p>Now you’ll try reading in data from a variety of types of file formats.</p>
<p>Try the following tasks:</p>
<ul>
<li>What type of flat file do you think the “ld_genetics.txt” file is? See if you can read it in and save it as the R object <code>ld_genetics</code>. Use the <code>summary</code> function to check out basic statistics on the data.</li>
<li>Check out the file “measles_data/02-09-2015.txt”. What type of flat file do you think it is? Since it’s in a subdirectory, you’ll need to tell R how to get to it from the project directory, using something called a <strong>relative pathname</strong> (we’ll talk about this a lot more in the next section of the lecture). Read this file into R as an object named <code>ca_measles</code>, using the relative pathname (“measles_data/02-09-2015.txt”) in place of the file name in the <code>read_csv</code> function call. Use the <code>col_names</code> option to name the columns “city” and “count”. What would the default column names be if you didn’t use this option (try this out by running <code>read_csv</code> without the <code>col_names</code> option)?</li>
<li>Read in the Excel file “icd-10.xls” and assign it to the object name <code>idc10</code>. Use the <a href="https://github.com/hadley/readxl"><code>readxl</code> package to do that</a> (examples are at the bottom of the linked page).</li>
<li>Read in the SAS file <code>icu.sas7bdat</code>. To do this, use the <a href="https://github.com/hadley/haven"><code>haven</code> package</a>. Read the file into the R object <code>icu</code>.</li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the `readr` package</span>
<span class="kw">library</span>(readr)

<span class="co"># Use `read_tsv` to read this file. </span>
ld_genetics &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;ld_genetics.txt&quot;</span>)
<span class="kw">summary</span>(ld_genetics)

<span class="co"># Use `read_tsv` to read this file. Because the first line</span>
<span class="co"># of the file is *not* the column names, you need to specify what the column</span>
<span class="co"># names should be with the `col_names` parameter. </span>
ca_measles &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;measles_data/02-09-2015.txt&quot;</span>,
                       <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;city&quot;</span>, <span class="st">&quot;count&quot;</span>))
<span class="kw">head</span>(ca_measles)

<span class="co"># You&#39;ll need the `readxl` package to read in this file. Load that. </span>
<span class="kw">library</span>(readxl)

<span class="co"># Use the `read_excel` function to read in the file. </span>
icd10 &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;icd-10.xls&quot;</span>)
<span class="kw">head</span>(icd10)

<span class="co"># You&#39;ll need the `haven` function to read in this file. Load that.</span>
<span class="kw">library</span>(haven)

<span class="co"># Use the `read_sas` function to read in this file.</span>
icu &lt;-<span class="st"> </span><span class="kw">read_sas</span>(<span class="st">&quot;icu.sas7bdat&quot;</span>)
icu[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
</div>
<div id="directory-structure-1" class="section level3">
<h3><span class="header-section-number">2.7.3</span> Directory structure</h3>
<p>Once you have the data, I’d like you to try using <code>setwd()</code> to move around the directories on your computer. For this section of the exercise, you’ll also try to open the same file from different working directories, to get practice using absolute and relative file pathnames.</p>
<p>Start by changing your working directory to the “data” subdirectory you just downloaded. For me, the absolute path to that is <code>/Users/brookeanderson/RProgrammingForResearch/data</code>, so to change my working directory to this one using an absolute file pathname, I would run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="st">&quot;/Users/brookeanderson/RProgrammingForResearch/data&quot;</span>)
<span class="kw">getwd</span>()</code></pre></div>
<p>The absolute pathname will be different for each person, based on the directories on his or her computer and where he or she saved this particular directory.</p>
<div class="rmdnote">
<p>
Since “~” is shorthand for my home directory (“/Users/brookeanderson”), I could also use the absolute pathname “~/RProgrammingForResearch/data” when setting this directory as my working directory.
</p>
</div>
<p>Now, use the <code>list.files</code> function to make sure you have all the files that you just pulled in your current working directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>()</code></pre></div>
<pre><code>##  [1] &quot;accident.csv&quot;                                               
##  [2] &quot;App-1&quot;                                                      
##  [3] &quot;App-2&quot;                                                      
##  [4] &quot;AWOIS_Wrecks_KnownYear.tab&quot;                                 
##  [5] &quot;AWOIS_Wrecks.csv&quot;                                           
##  [6] &quot;country_timeseries.csv&quot;                                     
##  [7] &quot;daily_show_guests.csv&quot;                                      
##  [8] &quot;deaths-weather.csv&quot;                                         
##  [9] &quot;DRUG_CLASS_I_Mean_Cmax_Trough_Efficacy_R_DATA_ANALYSIS.xlsx&quot;
## [10] &quot;example_choropleth.Rdata&quot;                                   
## [11] &quot;fars_colorado.RData&quot;                                        
## [12] &quot;icd-10.xls&quot;                                                 
## [13] &quot;ICU_Data_Code_Sheet.pdf&quot;                                    
## [14] &quot;icu.sas7bdat&quot;                                               
## [15] &quot;ld_genetics.txt&quot;                                            
## [16] &quot;measles_data&quot;                                               
## [17] &quot;mexico_deaths.csv&quot;                                          
## [18] &quot;mexico_exposure.csv&quot;                                        
## [19] &quot;R_data_analysis_class_project__second_data_set&quot;             
## [20] &quot;serial_map_data.csv&quot;                                        
## [21] &quot;serial_phone_data.csv&quot;                                      
## [22] &quot;The_templates&quot;                                              
## [23] &quot;titanic.csv&quot;</code></pre>
<p>Try the following tasks:</p>
<ul>
<li>Read in the ebola data in <code>country_timeseries.csv</code>. Assign it to an R object named <code>ebola</code>. How many rows and columns does it have? What are the names of the columns?</li>
<li>Now try moving up one directory from your current working directory (which should be the “data” directory), into the directory you created for this course. What happens if you use the same code as before to read in the file? What do you need to change to be able to read the file in from here? Try to read in the data from here using:
<ul>
<li>A relative pathname</li>
<li>An absolute pathname</li>
</ul></li>
<li>Now move your working directory to be the subdirectory of “data” called “measles_data”. Try to read in the Ebola data from this working directory using:
<ul>
<li>A relative pathname</li>
<li>An absolute pathname</li>
</ul></li>
<li>Which method (absolute or relative pathnames) always used the same code, regardless of your current working directory? Which method used different code, depending on the starting working directory?</li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()  ## Make sure you&#39;re in the &quot;data&quot; directory to start</code></pre></div>
<pre><code>## [1] &quot;/Users/brookeanderson/RProgrammingForResearch/data&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;country_timeseries.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##         Date Day Cases_Guinea Cases_Liberia Cases_SierraLeone
## 1   1/5/2015 289         2776            NA             10030
## 2   1/4/2015 288         2775            NA              9780
## 3   1/3/2015 287         2769          8166              9722
## 4   1/2/2015 286           NA          8157                NA
## 5 12/31/2014 284         2730          8115              9633</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(ebola) <span class="co"># To figure out number of rows and columns</span></code></pre></div>
<pre><code>## [1] 122  18</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(ebola) <span class="co"># To figure out column names</span></code></pre></div>
<pre><code>##  [1] &quot;Date&quot;                &quot;Day&quot;                 &quot;Cases_Guinea&quot;       
##  [4] &quot;Cases_Liberia&quot;       &quot;Cases_SierraLeone&quot;   &quot;Cases_Nigeria&quot;      
##  [7] &quot;Cases_Senegal&quot;       &quot;Cases_UnitedStates&quot;  &quot;Cases_Spain&quot;        
## [10] &quot;Cases_Mali&quot;          &quot;Deaths_Guinea&quot;       &quot;Deaths_Liberia&quot;     
## [13] &quot;Deaths_SierraLeone&quot;  &quot;Deaths_Nigeria&quot;      &quot;Deaths_Senegal&quot;     
## [16] &quot;Deaths_UnitedStates&quot; &quot;Deaths_Spain&quot;        &quot;Deaths_Mali&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Move up one directory
<span class="kw">setwd</span>(<span class="st">&quot;..&quot;</span>)
<span class="kw">getwd</span>() 

## Get the file using the relative pathname
ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/country_timeseries.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##         Date Day Cases_Guinea Cases_Liberia Cases_SierraLeone
## 1   1/5/2015 289         2776            NA             10030
## 2   1/4/2015 288         2775            NA              9780
## 3   1/3/2015 287         2769          8166              9722
## 4   1/2/2015 286           NA          8157                NA
## 5 12/31/2014 284         2730          8115              9633</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Get the file using the absolute pathname
abs_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;/Users/brookeanderson/RProgrammingForResearch/&quot;</span>,
                   <span class="st">&quot;data/country_timeseries.csv&quot;</span>)
abs_path</code></pre></div>
<pre><code>## [1] &quot;/Users/brookeanderson/RProgrammingForResearch/data/country_timeseries.csv&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(abs_path, <span class="dt">header =</span> <span class="ot">TRUE</span>) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##         Date Day Cases_Guinea Cases_Liberia Cases_SierraLeone
## 1   1/5/2015 289         2776            NA             10030
## 2   1/4/2015 288         2775            NA              9780
## 3   1/3/2015 287         2769          8166              9722
## 4   1/2/2015 286           NA          8157                NA
## 5 12/31/2014 284         2730          8115              9633</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Reset your working directory as your directory for this course
## and then check that you&#39;re in the right place
<span class="kw">getwd</span>()</code></pre></div>
<pre><code>## [1] &quot;/Users/brookeanderson/RProgrammingForResearch&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Move into the measles_data subdirectory
<span class="kw">setwd</span>(<span class="st">&quot;data/measles_data&quot;</span>)
<span class="kw">getwd</span>()</code></pre></div>
<pre><code>## [1] &quot;/Users/brookeanderson/RProgrammingForResearch/data/measles_data&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Get the file using the relative pathname
ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../country_timeseries.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##         Date Day Cases_Guinea Cases_Liberia Cases_SierraLeone
## 1   1/5/2015 289         2776            NA             10030
## 2   1/4/2015 288         2775            NA              9780
## 3   1/3/2015 287         2769          8166              9722
## 4   1/2/2015 286           NA          8157                NA
## 5 12/31/2014 284         2730          8115              9633</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the file using the absolute pathname (note: we&#39;ve already assigned</span>
<span class="co"># the absolute pathname in the `abs_path` object, so we can just use that </span>
<span class="co"># object in the `read.csv` call here, rather than typing out the full </span>
<span class="co"># absolute pathname again.)</span>
ebola &lt;-<span class="st"> </span><span class="kw">read.csv</span>(abs_path, <span class="dt">header =</span> <span class="ot">TRUE</span>) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##         Date Day Cases_Guinea Cases_Liberia Cases_SierraLeone
## 1   1/5/2015 289         2776            NA             10030
## 2   1/4/2015 288         2775            NA              9780
## 3   1/3/2015 287         2769          8166              9722
## 4   1/2/2015 286           NA          8157                NA
## 5 12/31/2014 284         2730          8115              9633</code></pre>
<p>If you have extra time:</p>
<ul>
<li>Find out some more about this Ebola dataset by checking out <a href="https://github.com/cmrivers/ebola">Caitlin Rivers’ Ebola data GitHub repository</a>. Who is Caitlin Rivers? How did she put this dataset together?</li>
<li>Search for R code related to Ebola research on GitHub. Go to the <a href="https://github.com">GitHub home page</a> and use the search bar to search for “ebola”. On the results page, scroll down and use the “Language” sidebar on the left to choose repositories with R code. Did you find any interesting projects?</li>
<li>When you <code>list.files()</code> when your working directory is the “data” directory, almost everything listed has a file extension, like <code>.csv</code>, <code>.xls</code>, <code>.sas7bdat</code>. One thing does not. Which one? Why does this listing not have a file extension?</li>
</ul>
</div>
<div id="cleaning-up-data-1" class="section level3">
<h3><span class="header-section-number">2.7.4</span> Cleaning up data #1</h3>
<p>Try out the following tasks:</p>
<ul>
<li>Copy the following code into an R script. Figure out what each line does, and add comments to each line of code describing what the code is doing.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Copy this code to an R script and add comments describing what each line is doing</span>
<span class="kw">library</span>(haven)
icu &lt;-<span class="st"> </span><span class="kw">read_sas</span>(<span class="st">&quot;data/icu.sas7bdat&quot;</span>)

icu &lt;-<span class="st"> </span><span class="kw">select</span>(icu, ID, AGE, GENDER)

icu &lt;-<span class="st"> </span><span class="kw">rename</span>(icu, 
              <span class="dt">id =</span> ID,
              <span class="dt">age =</span> AGE,
              <span class="dt">gender =</span> GENDER)

icu &lt;-<span class="st"> </span><span class="kw">mutate</span>(icu,
              <span class="dt">gender =</span> <span class="kw">factor</span>(gender, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)),
              <span class="dt">id =</span> <span class="kw">as.character</span>(id))

icu</code></pre></div>
<ul>
<li>Following previous parts of the in-course exercise, you have an R object called <code>ebola</code> (if you need to, use some code from earlier in this in-course exercise to read in the data and create that object). Create an object called <code>ebola_liberia</code> that only has the columns with the date and the number of cases and deaths in Liberia. How many columns does this new dataframe have? How many observations?</li>
<li>Change the column names to <code>date</code>, <code>cases</code>, and <code>deaths</code>.</li>
<li>Add a column called <code>ratio</code> that has the ratio of deaths to cases for each observation (i.e., death counts divided by case counts).</li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the dplyr package</span>
<span class="kw">library</span>(dplyr)

## Create a subset with just the Liberia columns and Date
ebola_liberia &lt;-<span class="st"> </span><span class="kw">select</span>(ebola, Date, Cases_Liberia, Deaths_Liberia)
<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>##         Date Cases_Liberia Deaths_Liberia
## 1   1/5/2015            NA             NA
## 2   1/4/2015            NA             NA
## 3   1/3/2015          8166           3496
## 4   1/2/2015          8157           3496
## 5 12/31/2014          8115           3471
## 6 12/28/2014          8018           3423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## How many colums and rows does the whole dataset have (could also use `dim`)?
<span class="kw">ncol</span>(ebola_liberia)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(ebola_liberia)</code></pre></div>
<pre><code>## [1] 122</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Rename the columns
ebola_liberia &lt;-<span class="st"> </span><span class="kw">rename</span>(ebola_liberia,
                        <span class="dt">date =</span> Date,
                        <span class="dt">cases =</span> Cases_Liberia,
                        <span class="dt">deaths =</span> Deaths_Liberia)
<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>##         date cases deaths
## 1   1/5/2015    NA     NA
## 2   1/4/2015    NA     NA
## 3   1/3/2015  8166   3496
## 4   1/2/2015  8157   3496
## 5 12/31/2014  8115   3471
## 6 12/28/2014  8018   3423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add a `ratio` column
ebola_liberia &lt;-<span class="st"> </span><span class="kw">mutate</span>(ebola_liberia, <span class="dt">ratio =</span> deaths <span class="op">/</span><span class="st"> </span>cases)
<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>##         date cases deaths     ratio
## 1   1/5/2015    NA     NA        NA
## 2   1/4/2015    NA     NA        NA
## 3   1/3/2015  8166   3496 0.4281166
## 4   1/2/2015  8157   3496 0.4285889
## 5 12/31/2014  8115   3471 0.4277264
## 6 12/28/2014  8018   3423 0.4269144</code></pre>
</div>
<div id="cleaning-up-data-2" class="section level3">
<h3><span class="header-section-number">2.7.5</span> Cleaning up data #2</h3>
<ul>
<li>For the <code>ebola_liberia</code> dataframe, what class is the <code>date</code> column currently in? Convert it to a Date class. What are the starting and ending dates of observations in this dataframe?</li>
<li>This data has earliest dates last and latest dates first. Often, we want our data in chronological order. Change the dataset so it’s in chronological order, from the observation with the earliest date to the one with the latest date.</li>
<li>Filter out all rows from the <code>ebola_liberia</code> dataframe that are missing death counts for Liberia. How many rows are in the dataframe now?</li>
<li>Create a new object called <code>first_five</code> that has only the five observations with the highest death counts in Liberia. What date in this dataset had the most deaths?</li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## What class is the `date` column?
<span class="kw">class</span>(ebola_liberia<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Use the `mdy` from `lubridate` to convert to Date class
<span class="kw">library</span>(lubridate)
ebola_liberia &lt;-<span class="st"> </span><span class="kw">mutate</span>(ebola_liberia, 
                        <span class="dt">date =</span> <span class="kw">mdy</span>(date))
<span class="kw">class</span>(ebola_liberia<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(ebola_liberia<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;2015-01-05&quot; &quot;2015-01-04&quot; &quot;2015-01-03&quot; &quot;2015-01-02&quot; &quot;2014-12-31&quot;
## [6] &quot;2014-12-28&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## What are the starting and ending dates?
<span class="kw">range</span>(ebola_liberia<span class="op">$</span>date)</code></pre></div>
<pre><code>## [1] &quot;2014-03-22&quot; &quot;2015-01-05&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Re-order the dataset from first date to last date
ebola_liberia &lt;-<span class="st"> </span><span class="kw">arrange</span>(ebola_liberia, date)
<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>##         date cases deaths ratio
## 1 2014-03-22    NA     NA    NA
## 2 2014-03-24    NA     NA    NA
## 3 2014-03-25    NA     NA    NA
## 4 2014-03-26    NA     NA    NA
## 5 2014-03-27     8      6  0.75
## 6 2014-03-28     3      3  1.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Filter out the rows that are missing death counts for Liberia
ebola_liberia &lt;-<span class="st"> </span><span class="kw">filter</span>(ebola_liberia, <span class="op">!</span><span class="kw">is.na</span>(deaths))
<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>##         date cases deaths     ratio
## 1 2014-03-27     8      6 0.7500000
## 2 2014-03-28     3      3 1.0000000
## 3 2014-03-29     7      2 0.2857143
## 4 2014-03-31     8      4 0.5000000
## 5 2014-04-01     8      5 0.6250000
## 6 2014-04-04    18      7 0.3888889</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(ebola_liberia)</code></pre></div>
<pre><code>## [1] 81</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create an object with just the top five observations in terms of death counts
first_five &lt;-<span class="st"> </span><span class="kw">arrange</span>(ebola_liberia, <span class="kw">desc</span>(deaths)) <span class="co"># First, rearrange the rows by deaths</span>
first_five &lt;-<span class="st"> </span><span class="kw">slice</span>(first_five, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="co"># Limit the dataframe to the first five rows</span>
first_five <span class="co"># Two days tied for the highest deaths counts (Jan. 2 and 3, 2015).</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   date       cases deaths ratio
##   &lt;date&gt;     &lt;int&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 2015-01-02  8157   3496 0.429
## 2 2015-01-03  8166   3496 0.428
## 3 2014-12-31  8115   3471 0.428
## 4 2014-12-28  8018   3423 0.427
## 5 2014-12-24  7977   3413 0.428</code></pre>
<p>If you have extra time:</p>
<ul>
<li>Try using the basic plotting function, <code>plot()</code>, to plot the number of cases of Ebola over time in Liberia from this dataframe. Do you think that the <code>cases</code> variable is measuring the count of cases for that day, or the cumulative number of cases up to that day? See if you can figure out more on Caitlin Rivers’ GitHub documentation. Do you notice any potential data quality issues in this data? <em>Hint: The <code>plot()</code> function takes, as required arguments, the vector you want to plot on the x-axis and then the vector you want to plot on the y-axis, like <code>plot([x vector], [y vector])</code>. If you are pulling the vectors from a dataset, you will need to use indexing to pull out the column you want as a vector, like <code>plot([dataframe name]$[column name for x], [dataframe]$[column name for y])</code>.</em></li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot the data
<span class="kw">plot</span>(ebola_liberia<span class="op">$</span>date, ebola_liberia<span class="op">$</span>cases)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<div id="piping-1" class="section level3">
<h3><span class="header-section-number">2.7.6</span> Piping</h3>
<p>Try the following tasks:</p>
<ul>
<li>Copy the following “piped” code into an R script. Figure out what each line does, and add comments to each line of code describing what the code is doing.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Copy this code to an R script and add comments describing what each line is doing</span>
<span class="kw">library</span>(haven)
icu &lt;-<span class="st"> </span><span class="kw">read_sas</span>(<span class="st">&quot;data/icu.sas7bdat&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(ID, AGE, GENDER) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">id =</span> ID,
         <span class="dt">age =</span> AGE, 
         <span class="dt">gender =</span> GENDER) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">factor</span>(gender, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)),
         <span class="dt">id =</span> <span class="kw">as.character</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(age) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)

icu</code></pre></div>
<ul>
<li>In previous sections of the in-course exercise, you have created code to read in and clean the Ebola dataset to create <code>ebola_liberia</code>. This included the following cleaning steps: (1) selecting certain columns, (2) renaming those columns, (3) adding a <code>ratio</code> column, (4) mutating the <code>date</code> column to a Date class, (5) re-ordering the observations from earliest to latest date, and (6) removing observations for which the count of deaths in Liberia is missing. Re-write this code to create and clean <code>ebola_liberia</code> as “piped” code. Start from reading in the raw data.</li>
</ul>
<p>Example R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ebola_liberia &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/country_timeseries.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Date, Cases_Liberia, Deaths_Liberia) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">date =</span> Date, 
         <span class="dt">cases =</span> Cases_Liberia, 
         <span class="dt">deaths =</span> Deaths_Liberia) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ratio =</span> deaths <span class="op">/</span><span class="st"> </span>cases) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">mdy</span>(date)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(cases))

<span class="kw">head</span>(ebola_liberia)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   date       cases deaths ratio
##   &lt;date&gt;     &lt;int&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 2014-03-27     8      6 0.750
## 2 2014-03-28     3      3 1.00 
## 3 2014-03-29     7      2 0.286
## 4 2014-03-31     8      4 0.500
## 5 2014-04-01     8      5 0.625
## 6 2014-04-04    18      7 0.389</code></pre>
</div>
<div id="a-taste-of-whats-to-come" class="section level3">
<h3><span class="header-section-number">2.7.7</span> A taste of what’s to come…</h3>
<p>Here’s an example to give you a feel for why it’s worth learning all these different things about directories, <code>list.files</code>, and pathnames.</p>
<p>The <code>measles_data</code> subdirectory includes counts of measles made at different times in different cities in California. Say that we wanted to read them all in and make put them into one long dataframe with the variables <code>city</code>, <code>count</code>, and <code>date</code>. You can put together the things you’ve learned so far, along with a few new ideas (including doing a loop), to do this very easily.</p>
<p>We’ll talk more later about using loops and functions to make your programming more efficient, but for right now just look through this code and see if you can get a feel for how it’s working (make sure your directory for this course is your working directory):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create a vector of all the file names in the `measles_data` subdirectory
measles_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;data/measles_data&quot;</span>)
measles_files</code></pre></div>
<pre><code>##  [1] &quot;02-09-2015.txt&quot; &quot;02-11-2015.txt&quot; &quot;02-13-2015.txt&quot; &quot;02-18-2015.txt&quot;
##  [5] &quot;02-20-2015.txt&quot; &quot;02-23-2015.txt&quot; &quot;02-25-2015.txt&quot; &quot;02-27-2015.txt&quot;
##  [9] &quot;03-02-2015.txt&quot; &quot;03-06-2015.txt&quot; &quot;03-13-2015.txt&quot; &quot;03-20-2015.txt&quot;
## [13] &quot;03-27-2015.txt&quot; &quot;04-03-2015.txt&quot; &quot;04-10-2015.txt&quot; &quot;04-17-2015.txt&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create a vector of all the dates for files by taking the 
## `.txt` off each of these file names and change it into
## a date
measles_dates &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;.txt&quot;</span>, <span class="st">&quot;&quot;</span>, measles_files)
measles_dates</code></pre></div>
<pre><code>##  [1] &quot;02-09-2015&quot; &quot;02-11-2015&quot; &quot;02-13-2015&quot; &quot;02-18-2015&quot; &quot;02-20-2015&quot;
##  [6] &quot;02-23-2015&quot; &quot;02-25-2015&quot; &quot;02-27-2015&quot; &quot;03-02-2015&quot; &quot;03-06-2015&quot;
## [11] &quot;03-13-2015&quot; &quot;03-20-2015&quot; &quot;03-27-2015&quot; &quot;04-03-2015&quot; &quot;04-10-2015&quot;
## [16] &quot;04-17-2015&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(measles_dates)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">measles_dates &lt;-<span class="st"> </span><span class="kw">mdy</span>(measles_dates)
measles_dates</code></pre></div>
<pre><code>##  [1] &quot;2015-02-09&quot; &quot;2015-02-11&quot; &quot;2015-02-13&quot; &quot;2015-02-18&quot; &quot;2015-02-20&quot;
##  [6] &quot;2015-02-23&quot; &quot;2015-02-25&quot; &quot;2015-02-27&quot; &quot;2015-03-02&quot; &quot;2015-03-06&quot;
## [11] &quot;2015-03-13&quot; &quot;2015-03-20&quot; &quot;2015-03-27&quot; &quot;2015-04-03&quot; &quot;2015-04-10&quot;
## [16] &quot;2015-04-17&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Before I show the loop, let me talk you through some 
## of the parts of it:
i &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># I&#39;m setting the index to 1</span>

## Now I&#39;ll use `paste0` to create the first file name
## I want to read.
file_name &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;data/measles_data/&quot;</span>, measles_files[i])
file_name</code></pre></div>
<pre><code>## [1] &quot;data/measles_data/02-09-2015.txt&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Now I&#39;ll read in that tab-delimited file
df &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(file_name, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;city&quot;</span>, <span class="st">&quot;count&quot;</span>))
<span class="kw">head</span>(df)</code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   city               count
##   &lt;chr&gt;              &lt;int&gt;
## 1 ALAMEDA                6
## 2 LOS ANGELES           20
## 3 City of Long Beach     2
## 4 City of Pasadena       4
## 5 MARIN                  2
## 6 ORANGE                34</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Now I&#39;ll add on a column with the date for all the 
## values from that file. Notice that I&#39;m using `i` to 
## index this, as well

df &lt;-<span class="st"> </span><span class="kw">mutate</span>(df, <span class="dt">date =</span> measles_dates[i])
<span class="kw">head</span>(df)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   city               count date      
##   &lt;chr&gt;              &lt;int&gt; &lt;date&gt;    
## 1 ALAMEDA                6 2015-02-09
## 2 LOS ANGELES           20 2015-02-09
## 3 City of Long Beach     2 2015-02-09
## 4 City of Pasadena       4 2015-02-09
## 5 MARIN                  2 2015-02-09
## 6 ORANGE                34 2015-02-09</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Loop through and read in files. After the first file,
## add on the new information to the data that&#39;s already 
## been read in. Note that you can use `rbind` to add on 
## new rows to a dataframe as long as the new and old rows
## have the same number of columns and the same column names.
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(measles_files)){
        file_name &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;data/measles_data/&quot;</span>, measles_files[i])
        df &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(file_name, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;city&quot;</span>, <span class="st">&quot;count&quot;</span>))
        df &lt;-<span class="st"> </span><span class="kw">mutate</span>(df, <span class="dt">date =</span> measles_dates[i])
        <span class="cf">if</span>(i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){
                ca_measles &lt;-<span class="st"> </span>df
        } <span class="cf">else</span> { 
                 ca_measles &lt;-<span class="st"> </span><span class="kw">rbind</span>(ca_measles, df)
                }
}

<span class="kw">dim</span>(ca_measles)</code></pre></div>
<pre><code>## [1] 232   3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ca_measles)</code></pre></div>
<pre><code>##      city               count             date           
##  Length:232         Min.   : 1.000   Min.   :2015-02-09  
##  Class :character   1st Qu.: 2.000   1st Qu.:2015-02-20  
##  Mode  :character   Median : 4.000   Median :2015-03-02  
##                     Mean   : 8.698   Mean   :2015-03-07  
##                     3rd Qu.:12.000   3rd Qu.:2015-03-27  
##                     Max.   :35.000   Max.   :2015-04-17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(<span class="kw">subset</span>(ca_measles, city <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;LOS ANGELES&quot;</span>, <span class="st">&quot;SAN DIEGO&quot;</span>, <span class="st">&quot;ORANGE&quot;</span>)),
       <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> count)) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">geom_line</span>()  <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>city)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-72-1.png" width="960" /></p>

</div>
</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-preliminaries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-a-vocabulary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/geanders/RProgrammingForResearch/edit/master/02-databasics.Rmd",
"text": "Edit"
},
"download": ["RProgrammingForResearch.pdf", "RProgrammingForResearch.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
